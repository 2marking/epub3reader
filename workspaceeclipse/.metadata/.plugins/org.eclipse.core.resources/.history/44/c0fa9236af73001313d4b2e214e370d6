package it.angrydroids.epub3reader;

import android.os.Bundle;
import android.app.Activity;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.View;
import android.view.ViewGroup;
import android.webkit.WebView;

public class DataView extends SplitPanel {
	protected boolean created;
	protected WebView view;
	protected String data;
	
	@Override
	public View onCreateView(LayoutInflater inflater,ViewGroup container,Bundle savedInstanceState)	{
		super.onCreateView(inflater, container, savedInstanceState);
		created = false;
		data = "";
		View v = inflater.inflate(R.layout.activity_data_view, container, false);
		return v;
	}
	
	@Override
    public void onActivityCreated(Bundle saved) {
		super.onActivityCreated(saved);
		view = (WebView) getView().findViewById(R.id.Viewport);
		
		// override load url
		
		view.loadData(data, getActivity().getApplicationContext().getResources().getString(R.string.textOrHTML), null);
		created = true;
	}
	
	public void loadData(String source)
	{
		data=source;
		if(created)
			view.loadData(data, getActivity().getApplicationContext().getResources().getString(R.string.textOrHTML), null);
	}

	@Override
	public void saveState(Editor editor)
	{
		editor.putString(getTag()+"data", data);
	}
	
	@Override
	public void loadState(SharedPreferences preferences)
	{
		loadData(preferences.getString(getTag()+"data", ""));
	}
}
